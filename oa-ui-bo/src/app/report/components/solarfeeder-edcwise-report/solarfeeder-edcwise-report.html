<div fxLayout="row" fxLayoutWrap="wrap">
  <div fxFlex.gt-sm="100%" fxFlex="100">
    
    <mat-card>
      <mat-card-title >
          SOLAR FEEDER EDC WISE REPORT
         </mat-card-title>
         <div fxLayout="row" fxLayoutAlign="start center">

           <mat-form-field class="ml-xs mr-xs" fxFlex.gt-sm="100%"  >
                  <mat-select class="ml-xs mr-xs" style="width: 100%;" [disabled]="disableEdc" placeholder="Edc Name" [(ngModel)]='dispOrgCode' [required]="isMandatory" (ngModelChange)="filterSubstations(dispOrgCode)">
                    <mat-option *ngFor="let org of orgList" [value]="org.code">
                      {{org.code}} - {{org.name}}
                    </mat-option>
                  </mat-select>
                </mat-form-field>

          <mat-form-field class="ml-xs mr-xs" style="width: 100%;">
            <mat-select class="ml-xs mr-xs" style="width: 100%;" placeholder="Substation" [(ngModel)]='substationName'>
              <mat-option *ngFor="let fuelTypes of subsationById" [value]="fuelTypes.name">
                {{fuelTypes.name | uppercase}}
              </mat-option>
            </mat-select>
          </mat-form-field>

          <mat-form-field class="ml-xs mr-xs"  fxFlex.gt-sm="100%">
            <mat-select class="ml-xs mr-xs" style="width: 100%;" placeholder="Month" [(ngModel)]='readMonth'>
              <mat-option *ngFor="let month of months" [value]="month.value">
                {{month.name}}
              </mat-option>
            </mat-select>
          </mat-form-field>

          <mat-form-field class="ml-xs mr-xs"  style="width: 100%;">
            <mat-select class="ml-xs mr-xs" style="width: 100%;" placeholder="Year" [(ngModel)]='readYear'>
              <mat-option *ngFor="let yr of Year" [value]="yr.id">
                {{yr.year}}
              </mat-option>
            </mat-select>
          </mat-form-field>         
    
            <mat-card-actions>				
              <button mat-raised-button color="primary" class="primary" (click)="searchResults()">Genarate Report</button>
            </mat-card-actions>
            <mat-card-actions>
            <button mat-raised-button color="accent" (click)="printReport()">
                <mat-icon>cloud_download</mat-icon>
                Download Pdf
            </button>
           </mat-card-actions>
           <mat-card-actions>
            <button mat-raised-button color="accent" (click)="exportAsXLSX()">
             <mat-icon>cloud_download</mat-icon>
             Download As XL</button>
           </mat-card-actions>

      </div>

          <mat-card-content>
            
                  
                  <div>
                      <ngx-datatable class="material" [rows]="opt" [columnMode]="'force'" [headerHeight]="50" [footerHeight]="50"
                        [rowHeight]="50" [scrollbarV]="true">
            
                       <ngx-datatable-column name="Sl.No">
                          <ng-template let-row="row" let-value="value" let-rowIndex="rowIndex" ngx-datatable-cell-template>
                            {{opt.indexOf(row)+1}}
            
                          </ng-template>
                        </ngx-datatable-column> 

                        <ngx-datatable-column name="EDC Name" *ngIf="Usertype!='EDC User'">
                          <ng-template let-row="row" let-value="value" ngx-datatable-cell-template>
                            {{row.op3}}
                          </ng-template>
                        </ngx-datatable-column>
            
                        <ngx-datatable-column name="Substation Name">
                          <ng-template let-row="row" let-value="value" ngx-datatable-cell-template>
                            {{row.op1}}
                          </ng-template>
                        </ngx-datatable-column>
            
                       
            
                   <ngx-datatable-column name="Feeder Name">
                    <ng-template let-row="row" let-value="value"  ngx-datatable-cell-template>
                        {{row.op4}}
                    </ng-template>
                  </ngx-datatable-column>

                        <ngx-datatable-column name="Total Services">
                          <ng-template let-row="row" let-value="value" ngx-datatable-cell-template>
                            {{row.op7}}
                          </ng-template>
                        </ngx-datatable-column>

                        <ngx-datatable-column name="Billed Services">
                          <ng-template let-row="row" let-value="value" ngx-datatable-cell-template>
                            {{row.op8}}
                          </ng-template>
                        </ngx-datatable-column>

                        <ngx-datatable-column name="Export Units">
                          <ng-template let-row="row" let-value="value" ngx-datatable-cell-template>
                            {{row.op9}}
                          </ng-template>
                        </ngx-datatable-column>

                        <ngx-datatable-column name="Feeder Line Length">
                          <ng-template let-row="row" let-value="value" ngx-datatable-cell-template>
                            {{row.op12}}
                          </ng-template>
                        </ngx-datatable-column>

                        <ngx-datatable-column name="Feeder Meter No">
                          <ng-template let-row="row" let-value="value" ngx-datatable-cell-template>
                            {{row.op5}}
                          </ng-template>
                        </ngx-datatable-column>
                        
                      </ngx-datatable>
            
                    </div>
              </mat-card-content>
              </mat-card>
      
  </div>
